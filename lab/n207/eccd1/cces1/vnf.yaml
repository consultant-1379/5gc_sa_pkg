vnflcm:
  vnfInstanceName: n280-eccd1-cces1
  vnfProductName: CCES
  vnfSoftwareVersion: 1.11.3+45
  instantiate_file: instantiate.json
  values_file: values.yaml
  clusterName: n280-eccd1
  namespace: cces1

skip-instantiation: false

day0:
  k8s-secret:
  # 1. Create Secret for LDAP Admin User
  - name: eric-sec-ldap-server-creds
    sources:
    - { type: literal, key: adminuser, value: sysadmin }
    - { type: literal, key: passwd, value: sysAdm1n@Day0 }
    - type: literal
      key: adminpasswd
      value: $6$fzLPYlRZCpweJMJC$AiNfP0WYE3npY8Za6GxMFoGj75TOl.TS6tmnnky2Bv5wY0Ek8RIoJlr9pyj0LF3wMMaNsNTUH4jp2lIHviJGS0
  # 2. Create the SNMP Alarm Provider Secret
  - name: snmp-alarm-provider-config
    sources:
    - { type: file, key: config.json, file: snmp-config.json }
  # 3. Create the Distributed Coordinator ED Service Secret
  - name: eric-data-distributed-coordinator-creds
    sources:
    - { type: literal, key: etcdpasswd, value: sysAdm1n@Day0 }
  # 4. Create Identity and Access Management Credentials Secret
  - name: eric-sec-access-mgmt-creds
    sources:
    - { type: literal, key: kcadminid, value: admin }
    - { type: literal, key: kcpasswd, value: sysAdm1n@Day0 }
  # 5. Create SFTP Secret
  - name: sftp-server-config
    sources:
    - { type: file, key: sftpConfig.json, file: sftp-config.json }

verify-running: true
ignore-not-running:
- eric-data-search-engine-curator

day1:
  access:
    oam: cces1-oam.n280-eccd1.sero.gic.ericsson.se
    ldap-admin:
      user: sysadmin
      pass: sysAdm1n@Day0
    users:
    - user: cces-admin
      pass: Dm5GC@S0lut!on
      pass_init: Changeme@1st
    - user: cces-sec
      pass: Dm5GC@S0lut!on
      pass_init: Changeme@1st
    configs:
    - file: user-config.xml
      proto: netconf
      pre-verify-pods-ready:
        check-interval: 5
        deployments:
        - eric-cm-yang-provider
      post-delay: 30
      retry-interval: 30

  k8s-config:
  - name: Create networkpolicy to allow accessing eric-pm-server and eric-data-search-engine
    cmd: |
      apply -f {file1}
      apply -f {file2}
    inline-files:
      file1: network-policy/eric-pm-server-allow.yaml
      file2: network-policy/eric-data-search-engine-allow.yaml
  - name: Modify eric-cces-nf-monitor Service
    cmd: |-
      patch svc eric-cces-nf-monitor -p '{"metadata":{"annotations":{"prometheus.io/scrape":"true"}}}' --type=merge
      patch svc eric-cces-nf-monitor -p '{"metadata":{"annotations":{"prometheus.io/path":"/metrics"}}}' --type=merge
      patch svc eric-cces-nf-monitor -p '{"metadata":{"annotations":{"prometheus.io/port":"8082"}}}' --type=merge
  - name: Create pm server ingress
    cmd: |-
      create ingress eric-pm-server --rule="eric-pm-server-cces.ingress.n280-eccd1.sero.gic.ericsson.se/*=eric-pm-server:9090"

  app-config:
  - file: external-certificates.xml
    user-id: 1
    proto: netconf
    post-delay: 10
  - file: nef-config.xml
    user-id: 0
    proto: netconf
    post-delay: 10
  - file: nef-diameter-config.xml
    user-id: 0
    proto: netconf
    post-delay: 10
  - file: nrfagent-config.xml
    user-id: 0
    proto: netconf
    post-delay: 10
  - file: ddc-config.xml
    user-id: 0
    proto: netconf
    post-delay: 60

  nef-provisioning:
    host: cces1-5g-prov.n280-eccd1.sero.gic.ericsson.se
    trustca: ../../../certs/RootCA/ca.crt
    client-cert: ../../../certs/n280-eccd1/cces1/cces1-prov-client.crt
    client-key: ../../../certs/n280-eccd1/cces1/cces1-prov-client.key
    prov-info:
    - api-path: Provisioning/generic/entity/v2
      data-file: nef-provisioning/1_ServiceProvider.xml
      method: POST
      headers:
        Content-Type: application/xml
        Accept: application/xml
    - api-path: Provisioning/generic/entity/v2
      data-file: nef-provisioning/2_ServiceProviderServiceSubscription.xml
      method: POST
      headers:
        Content-Type: application/xml
        Accept: application/xml
    - api-path: Provisioning/generic/entity/v2
      data-file: nef-provisioning/3_Application.xml
      method: POST
      headers:
        Content-Type: application/xml
        Accept: application/xml
    - api-path: Provisioning/generic/entity/v2
      data-file: nef-provisioning/4_ApplicationServiceSubscription.xml
      method: POST
      headers:
        Content-Type: application/xml
        Accept: application/xml
    - api-path: Provisioning/qos/v1/information/QI_001
      data-file: nef-provisioning/5_QoS_information.json
      method: PUT
      headers:
        Content-Type: application/json
    - api-path: Provisioning/qos/v1/information/QI_002
      data-file: nef-provisioning/6_QoS_information.json
      method: PUT
      headers:
        Content-Type: application/json


