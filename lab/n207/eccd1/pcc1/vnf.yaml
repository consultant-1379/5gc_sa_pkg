vnflcm:
  vnfInstanceName: n280-eccd1-pcc1
  vnfProductName: PCC
  vnfSoftwareVersion: CXP9041577_1.R57B

#skip-instantiation: true

day0:
  k8s-secret:
  # 1. Create Secret for LDAP Admin User
  - name: eric-pc-controller-ldap-admin-creds
    sources:
    - { type: literal, key: adminuser, value: sysadmin }
    - { type: literal, key: passwd, value: sysAdm1n@Day0 }
    - type: literal
      key: adminpasswd
      value: $6$fzLPYlRZCpweJMJC$AiNfP0WYE3npY8Za6GxMFoGj75TOl.TS6tmnnky2Bv5wY0Ek8RIoJlr9pyj0LF3wMMaNsNTUH4jp2lIHviJGS0

  # 2. Create the SNMP Alarm Provider Secret
  - name: eric-pc-controller-snmp-alarm-provider-config
    sources:
    - { type: file, key: config.json, file: snmp-config.json }

verify-running: true
ignore-not-running:
- eric-data-search-engine-curator

day1:
  access:
    oam: pcc1-oam.n280-eccd1.sero.gic.ericsson.se
    amf-oam: pcc1-pcmm-oam.n280-eccd1.sero.gic.ericsson.se
    ldap-admin:
      user: sysadmin
      pass: sysAdm1n@Day0
    users:
    - user: pcc-admin
      pass: Dm5GC@S0lut!on
      pass_init: Changeme@1st
    configs:
    - file: user-config.txt
      proto: ssh
      pre-delay: 30
      pre-verify-pods-ready:
        check-interval: 30
        deployments:
        - eric-cm-yang-provider
        - eric-pc-mm-controller
      post-delay: 30
      retry-interval: 30   

  app-config:

  - file: pc-mm-config-external-certificates.txt
    user-id: 0
    proto: ssh
    retry-interval: 30
    post-delay: 30
  - file: pc-mm-config.txt
    user-id: 0
    proto: ssh
    pre-delay: 10
    retry-interval: 30
    post-delay: 60
  - file: pc-sm-config-external-certificates.txt
    user-id: 0
    proto: ssh
    pre-delay: 10
    retry-interval: 30
    post-delay: 30
  - file: vpngw-config.txt
    user-id: 0
    proto: ssh
    retry-interval: 30
    post-delay: 10
  - file: pc-sm-config.txt
    user-id: 0
    proto: ssh
    retry-interval: 30
    post-verify-pods-ready:
      check-interval: 30
      deployments:
      - eric-pc-sm-smf-pgw-session
    post-delay: 120
  - file: pc-sm-config-nef.txt
    user-id: 0
    proto: ssh
    retry-interval: 30
    post-delay: 10
  - file: ddc-config.txt
    user-id: 0
    proto: ssh
    retry-interval: 30
    post-delay: 10
  - file: pc-sm-pm-job-user-defined.txt
    user-id: 0
    proto: ssh
    retry-interval: 30
    post-delay: 10

  k8s-config:
  - cmd: |-
      create ingress eric-data-search-engine --rule="pcc-eric-data-search-engine.ingress.n280-eccd1.sero.gic.ericsson.se/*=eric-data-search-engine:9200"
  - name: Upload SMF certificates
    cmd: |
      cp {file1} -c controller {pod}:/tmp/smf-sbi-server.pem
      cp {file2} -c controller {pod}:/tmp/smf-sbi-client.pem
      cp {file3} -c controller {pod}:/tmp/
    inline-files:
      file1: ../../../certs/n280-eccd1/pcc1/pcc1-smf-sbi-server.pem
      file2: ../../../certs/n280-eccd1/pcc1/pcc1-smf-sbi-client.pem
      file3: ../../../certs/RootCA/ca.crt
    inline-intermediate-values:
      pod: get pod -l app.kubernetes.io/name=eric-pc-sm-controller -o jsonpath='{.items[0].metadata.name}'
    post-delay: 30
  - name: Upload AMF certificates
    cmd: |
      cp {file1} -c eric-pc-mm-controller {pod}:/tmp/amf-sbi-client.p12
      cp {file2} -c eric-pc-mm-controller {pod}:/tmp/amf-sbi-server.p12
      cp {file3} -c eric-pc-mm-controller {pod}:/tmp/
    inline-files:
      file1: ../../../certs/n280-eccd1/pcc1/pcc1-amf-sbi-client.p12
      file2: ../../../certs/n280-eccd1/pcc1/pcc1-amf-sbi-server.p12
      file3: ../../../certs/RootCA/ca.crt
    inline-intermediate-values:
      pod: get pod -l app.kubernetes.io/name=eric-pc-mm-controller -l eric-pc-mm-controller-role=active -o jsonpath='{.items[0].metadata.name}'  
  - name: Create pm server ingress
    cmd: |-
      create ingress eric-pm-server --rule="eric-pm-server-pcc1.ingress.n280-eccd1.sero.gic.ericsson.se/*=eric-pm-server:9090"

